<div class="config-dialog">
  <mat-dialog-content>
    <div class="dialog-header">
      <h2 mat-dialog-title>{{ data.categoryName }} - Configuration</h2>
    </div>
    
    <div class="config-content">
      @if (isLoading()) {
        <div class="loading-container">
          <mat-spinner diameter="40"></mat-spinner>
          <p>Saving configuration...</p>
        </div>
      } @else if (hasError()) {
        <div class="error-container">
          <mat-icon color="warn">error</mat-icon>
          <p>{{ errorMessage() }}</p>
        </div>
      }
      
      <div class="config-editor-container">
        <label class="editor-label">Configuration JSON</label>
        <div #editor class="monaco-editor"></div>
        @if (!isValidJson && isEditing()) {
          <div class="error-message">
            <mat-icon color="warn">error</mat-icon>
            <span>Invalid JSON format</span>
          </div>
        }
        @if (!hasConfig && !isEditing()) {
          <div class="no-config-overlay">
            <mat-icon>settings</mat-icon>
            <p>No configuration available for this category.</p>
            <p class="help-text">Click "Add Configuration" to create one.</p>
          </div>
        }
      </div>
    </div>
  </mat-dialog-content>
  
  <mat-dialog-actions align="end">
    @if (isEditing()) {
      <button mat-button (click)="cancelEditing()" [disabled]="isLoading()">
        <mat-icon>cancel</mat-icon>
        Cancel
      </button>
      <button 
        mat-raised-button 
        color="primary" 
        (click)="saveConfig()" 
        [disabled]="!isValidJson || !hasChanges || isLoading()">
        <mat-icon>save</mat-icon>
        Save
      </button>
    } @else {
      @if (hasConfig) {
        <button mat-button (click)="startEditing()">
          <mat-icon>edit</mat-icon>
          Edit
        </button>
        <button mat-button color="warn" (click)="deleteConfig()">
          <mat-icon>delete</mat-icon>
          Delete
        </button>
      } @else {
        <button mat-raised-button color="primary" (click)="addConfiguration()">
          <mat-icon>add</mat-icon>
          Add Configuration
        </button>
      }
      <button mat-button (click)="onClose()">
        <mat-icon>close</mat-icon>
        Close
      </button>
    }
  </mat-dialog-actions>
</div>
